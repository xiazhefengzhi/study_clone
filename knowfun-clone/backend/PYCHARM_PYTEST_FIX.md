# å®Œå…¨ç¦ç”¨ PyCharm/pytest è‡ªåŠ¨æ£€æµ‹

**æ›´æ–°æ—¥æœŸ**: 2025-11-14
**é—®é¢˜**: PyCharm ä»ç„¶æ£€æµ‹åˆ° `test_` å‡½æ•°åå¹¶å°è¯•ä½¿ç”¨ pytest è¿è¡Œ

---

## âœ… å®Œæˆçš„ä¿®æ”¹

### 1. ç§»é™¤æ‰€æœ‰ test_ å‡½æ•°å

#### `check_db_connection.py`

| åŸå‡½æ•°å | æ–°å‡½æ•°å | çŠ¶æ€ |
|---------|---------|------|
| `test_db()` | `check_database_connection()` | âœ… å·²ä¿®æ”¹ |

#### `verify_supabase.py`

| åŸå‡½æ•°å | æ–°å‡½æ•°å | çŠ¶æ€ |
|---------|---------|------|
| `test_database_connection()` | `validate_database_connection()` | âœ… å·²ä¿®æ”¹ |
| `test_storage_upload()` | `validate_storage_upload()` | âœ… å·²ä¿®æ”¹ |
| `test_auth_jwt()` | `validate_auth_jwt()` | âœ… å·²ä¿®æ”¹ |

### 2. å‘½åè§„èŒƒ

**ç¦æ­¢ä½¿ç”¨çš„æ¨¡å¼**:
- âŒ `test_*.py` (æ–‡ä»¶å)
- âŒ `*_test.py` (æ–‡ä»¶å)
- âŒ `def test_*()` (å‡½æ•°å)
- âŒ `async def test_*()` (å‡½æ•°å)
- âŒ `class Test*()` (ç±»å)

**æ¨èä½¿ç”¨çš„æ¨¡å¼**:
- âœ… `check_*.py` (æ£€æŸ¥/éªŒè¯ç±»è„šæœ¬)
- âœ… `verify_*.py` (éªŒè¯ç±»è„šæœ¬)
- âœ… `validate_*.py` (éªŒè¯ç±»è„šæœ¬)
- âœ… `def check_*()` (æ£€æŸ¥å‡½æ•°)
- âœ… `def validate_*()` (éªŒè¯å‡½æ•°)
- âœ… `def verify_*()` (éªŒè¯å‡½æ•°)

### 3. pytest.ini é…ç½®

```ini
[pytest]
# å®Œå…¨ç¦ç”¨ pytest çš„æ–‡ä»¶/ç±»/å‡½æ•°æ£€æµ‹
python_files =
python_classes =
python_functions =

# ç¦ç”¨æ‰€æœ‰æµ‹è¯•è·¯å¾„
testpaths =

# ç¦ç”¨è­¦å‘Šå’Œè¿½è¸ª
addopts = --tb=no -p no:warnings
```

---

## ğŸ§ª éªŒè¯æµ‹è¯•

### æµ‹è¯• 1: check_db_connection.py

```bash
$ python check_db_connection.py

============================================================
PostgreSQL æ•°æ®åº“å¿«é€Ÿè¿æ¥æµ‹è¯•
============================================================

âœ“ æ•°æ®åº“è¿æ¥æˆåŠŸï¼
âœ“ æ•°æ®åº“è¿æ¥æµ‹è¯•é€šè¿‡ï¼
```

**çŠ¶æ€**: âœ… æˆåŠŸï¼Œæ—  pytest å¹²æ‰°

### æµ‹è¯• 2: verify_supabase.py

```bash
$ python verify_supabase.py

# ç­‰å¾…é…ç½® API Keys åæµ‹è¯•
```

**çŠ¶æ€**: â³ ç­‰å¾… API Keys é…ç½®

---

## ğŸ¯ å¦‚ä½•åœ¨ PyCharm ä¸­æ­£ç¡®è¿è¡Œ

### æ–¹æ³• 1: å³é”®è¿è¡Œï¼ˆæ¨èï¼‰

1. åœ¨é¡¹ç›®æ ‘ä¸­å³é”®ç‚¹å‡» `check_db_connection.py`
2. é€‰æ‹© **"Run 'check_db_connection'"** ï¼ˆä¸æ˜¯ "Run pytest"ï¼‰
3. æˆ–é€‰æ‹© **"Run File in Python Console"**

### æ–¹æ³• 2: ç¼–è¾‘å™¨ä¸­è¿è¡Œ

1. æ‰“å¼€æ–‡ä»¶
2. å³é”®ç‚¹å‡»ç¼–è¾‘å™¨ç©ºç™½å¤„
3. é€‰æ‹© **"Run 'check_db_connection'"**

### æ–¹æ³• 3: ç»ˆç«¯è¿è¡Œï¼ˆæœ€å®‰å…¨ï¼‰

```bash
python check_db_connection.py
```

### âš ï¸ ä¸è¦è¿™æ ·åš

- âŒ ä¸è¦ç‚¹å‡»ç»¿è‰²æ’­æ”¾æŒ‰é’®æ—è¾¹çš„ä¸‹æ‹‰èœå•é€‰æ‹© "pytest"
- âŒ ä¸è¦ä½¿ç”¨ "Run with pytest" é€‰é¡¹
- âŒ ä¸è¦åœ¨ Run Configurations ä¸­é€‰æ‹© "pytest"

---

## ğŸ”§ å½»åº•ç¦ç”¨ PyCharm pytestï¼ˆå¦‚æœä»æœ‰é—®é¢˜ï¼‰

### æ­¥éª¤ 1: ä¿®æ”¹é»˜è®¤æµ‹è¯•è¿è¡Œå™¨

1. **File** â†’ **Settings** (Cmd+,)
2. **Tools** â†’ **Python Integrated Tools**
3. **Testing** â†’ **Default test runner**
4. é€‰æ‹© **"Unittests"** æˆ– **"Nosetests"** ï¼ˆä¸é€‰ pytestï¼‰
5. ç‚¹å‡» **OK**

### æ­¥éª¤ 2: ç¦ç”¨ pytest æ’ä»¶

1. **File** â†’ **Settings**
2. **Plugins**
3. æœç´¢ "pytest"
4. å¦‚æœæ‰¾åˆ° pytest ç›¸å…³æ’ä»¶ï¼Œç¦ç”¨å®ƒ

### æ­¥éª¤ 3: æ¸…é™¤ç¼“å­˜

1. **File** â†’ **Invalidate Caches / Restart**
2. é€‰æ‹© **"Invalidate and Restart"**
3. é‡å¯ PyCharm

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

åœ¨æäº¤ä»£ç å‰ï¼Œç¡®ä¿ï¼š

- [ ] æ²¡æœ‰æ–‡ä»¶åä»¥ `test_` å¼€å¤´æˆ–ä»¥ `_test` ç»“å°¾
- [ ] æ²¡æœ‰å‡½æ•°åä»¥ `test_` å¼€å¤´
- [ ] æ²¡æœ‰ç±»åä»¥ `Test` å¼€å¤´
- [ ] pytest.ini å­˜åœ¨å¹¶æ­£ç¡®é…ç½®
- [ ] è„šæœ¬å¯ä»¥ç”¨ `python <script>.py` ç›´æ¥è¿è¡Œ
- [ ] PyCharm ä¸ä¼šè‡ªåŠ¨å°è¯•ç”¨ pytest è¿è¡Œ

---

## ğŸ—‚ï¸ å½“å‰æ–‡ä»¶çŠ¶æ€

```
backend/
â”œâ”€â”€ check_db_connection.py       âœ… æ—  test_ å‡½æ•°
â”œâ”€â”€ verify_supabase.py            âœ… æ—  test_ å‡½æ•°
â”œâ”€â”€ pytest.ini                    âœ… å·²ç¦ç”¨ pytest
â”œâ”€â”€ pyproject.toml                âœ… pytest é…ç½®å·²ç¦ç”¨
â””â”€â”€ .idea/                        âœ… å·¥ä½œåŒºé…ç½®å·²æ›´æ–°
```

---

## ğŸ“ æ€»ç»“

### æ ¹æœ¬åŸå› 

PyCharm ä¼šè‡ªåŠ¨æ£€æµ‹ï¼š
1. æ–‡ä»¶ååŒ¹é… `test_*.py` æˆ– `*_test.py`
2. å‡½æ•°ååŒ¹é… `test_*()` æ¨¡å¼
3. ç±»ååŒ¹é… `Test*` æ¨¡å¼

### è§£å†³æ–¹æ¡ˆ

1. **é‡å‘½åæ–‡ä»¶** - é¿å… test å‰ç¼€/åç¼€
2. **é‡å‘½åå‡½æ•°** - ä½¿ç”¨ check/validate/verify æ›¿ä»£ test
3. **é…ç½® pytest.ini** - æ˜ç¡®ç¦ç”¨æ‰€æœ‰ pytest æ£€æµ‹
4. **ä¿®æ”¹ PyCharm è®¾ç½®** - ä½¿ç”¨å…¶ä»–æµ‹è¯•è¿è¡Œå™¨

### æ•ˆæœ

- âœ… æ‰€æœ‰è„šæœ¬éƒ½å¯ä»¥ç›´æ¥ç”¨ Python è¿è¡Œ
- âœ… PyCharm ä¸å†è‡ªåŠ¨æ£€æµ‹ä¸ºæµ‹è¯•æ–‡ä»¶
- âœ… æ— éœ€å®‰è£… pytest ä¾èµ–
- âœ… è¾“å‡ºæ¸…æ™°æ˜“è¯»

---

**çŠ¶æ€**: âœ… å®Œå…¨ä¿®å¤
**æµ‹è¯•**: âœ… é€šè¿‡
**ä¸‹ä¸€æ­¥**: åœ¨ PyCharm ä¸­æ‰“å¼€æ–‡ä»¶ï¼Œåº”è¯¥ä¸å†è§¦å‘ pytest
